<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ma Cave √† Bi√®res</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap');
        
        * {
            font-family: 'Inter', sans-serif;
        }

        body {
            background: linear-gradient(to bottom right, #1e293b, #334155, #475569);
            min-height: 100vh;
        }

        .card {
            background: white;
            border-radius: 1rem;
            box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1), 0 2px 4px -1px rgba(0, 0, 0, 0.06);
            transition: all 0.3s ease;
        }

        .card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
        }

        .gradient-header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        }

        .btn-primary {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            transition: all 0.3s ease;
        }

        .btn-primary:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 20px rgba(102, 126, 234, 0.3);
        }

        .notification {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1000;
            animation: slideIn 0.3s ease-out;
        }

        @keyframes slideIn {
            from {
                transform: translateX(400px);
                opacity: 0;
            }
            to {
                transform: translateX(0);
                opacity: 1;
            }
        }

        .modal-backdrop {
            background: rgba(0, 0, 0, 0.5);
            backdrop-filter: blur(4px);
        }

        .beer-type-badge {
            display: inline-block;
            padding: 0.25rem 0.75rem;
            border-radius: 9999px;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .stock-low {
            background: #fef3c7;
            color: #92400e;
        }

        .stock-ok {
            background: #d1fae5;
            color: #065f46;
        }

        .stock-empty {
            background: #fee2e2;
            color: #991b1b;
        }

        .beer-image {
            width: 100%;
            height: 200px;
            object-fit: cover;
            border-radius: 0.5rem;
        }

        .image-upload-preview {
            width: 100%;
            max-height: 200px;
            object-fit: contain;
            border-radius: 0.5rem;
            margin-top: 0.5rem;
        }

        .file-upload-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
            width: 100%;
        }

        .file-upload-wrapper input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .file-upload-label {
            display: block;
            padding: 0.75rem 1rem;
            background: #f3f4f6;
            border: 2px dashed #d1d5db;
            border-radius: 0.5rem;
            cursor: pointer;
            text-align: center;
            transition: all 0.3s ease;
        }

        .file-upload-label:hover {
            background: #e5e7eb;
            border-color: #9ca3af;
        }

        .file-upload-label.has-file {
            background: #dbeafe;
            border-color: #3b82f6;
        }
    </style>
</head>
<body class="p-4 md:p-8">
    <!-- Notifications Container -->
    <div id="notifications"></div>

    <div class="max-w-7xl mx-auto">
        <!-- Header -->
        <div class="card gradient-header text-white p-6 md:p-8 mb-6">
            <div class="flex flex-col md:flex-row justify-between items-center gap-4">
                <div>
                    <h1 class="text-3xl md:text-5xl font-bold mb-2">
                        <i class="fas fa-beer"></i> Ma Cave √† Bi√®res
                    </h1>
                    <p class="text-lg opacity-90">Gestion professionnelle de votre collection</p>
                </div>
                <div class="flex flex-col gap-2 w-full md:w-auto">
                    <button onclick="showGitHubConfig()" 
                            class="bg-purple-600 hover:bg-purple-700 text-white font-semibold py-3 px-6 rounded-lg transition shadow-lg">
                        <i class="fas fa-cog"></i> <span id="configStatus">Configurer GitHub</span>
                    </button>
                    <button onclick="saveToGitHub()" id="saveToGitHubBtn"
                            class="bg-blue-600 hover:bg-blue-700 text-white font-semibold py-3 px-6 rounded-lg transition shadow-lg">
                        <i class="fas fa-save"></i> Sauvegarder donn√©es
                    </button>
                    <button onclick="publishToGitHub()" id="publishToGitHubBtn"
                            class="bg-teal-600 hover:bg-teal-700 text-white font-semibold py-3 px-6 rounded-lg transition shadow-lg">
                        <i class="fas fa-cloud-upload-alt"></i> Publier vitrine + donn√©es
                    </button>
                    <button onclick="compressAllPhotos()" 
                            class="bg-yellow-600 hover:bg-yellow-700 text-white font-semibold py-3 px-6 rounded-lg transition shadow-lg">
                        <i class="fas fa-compress"></i> Compresser photos
                    </button>
                </div>
				<div class="flex flex-col gap-2 w-full md:w-auto">
                    <button onclick="exportBackup()" 
                            class="bg-indigo-600 hover:bg-indigo-700 text-white font-semibold py-3 px-6 rounded-lg transition shadow-lg">
                        <i class="fas fa-download"></i> T√©l√©charger sauvegarde
                    </button>
                    <button onclick="document.getElementById('importFile').click()" 
                            class="bg-orange-600 hover:bg-orange-700 text-white font-semibold py-3 px-6 rounded-lg transition shadow-lg">
                        <i class="fas fa-upload"></i> Restaurer sauvegarde
                    </button>
                    <input type="file" id="importFile" accept=".json" style="display: none;" onchange="importBackup(event)">
                    <button onclick="exportToGitHub()" 
                            class="bg-green-600 hover:bg-green-700 text-white font-semibold py-3 px-6 rounded-lg transition shadow-lg">
                        <i class="fas fa-download"></i> T√©l√©charger vitrine
                    </button>
                    <button onclick="showGitHubGuide()" 
                            class="bg-gray-900 hover:bg-gray-800 text-white font-semibold py-3 px-6 rounded-lg transition">
                        <i class="fas fa-book"></i> Guide
                    </button>
                </div>
            </div>
        </div>

        <!-- Stats -->
        <div class="grid grid-cols-1 md:grid-cols-4 gap-4 mb-6">
            <div class="card p-6 text-center">
                <div class="text-4xl font-bold text-purple-600" id="totalBeers">0</div>
                <div class="text-gray-600 font-medium mt-2">Bi√®res diff√©rentes</div>
            </div>
            <div class="card p-6 text-center">
                <div class="text-4xl font-bold text-blue-600" id="total33cl">0</div>
                <div class="text-gray-600 font-medium mt-2">Bouteilles 33cl</div>
            </div>
            <div class="card p-6 text-center">
                <div class="text-4xl font-bold text-indigo-600" id="total75cl">0</div>
                <div class="text-gray-600 font-medium mt-2">Bouteilles 75cl</div>
            </div>
            <div class="card p-6 text-center">
                <div class="text-4xl font-bold text-green-600" id="totalLiters">0</div>
                <div class="text-gray-600 font-medium mt-2">Litres totaux</div>
            </div>
        </div>

        <!-- Formulaire -->
        <div class="card p-6 md:p-8 mb-6">
            <h2 class="text-2xl font-bold text-gray-800 mb-6">
                <i class="fas fa-plus-circle text-purple-600"></i> Ajouter une bi√®re
            </h2>
            <form id="beerForm" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4">
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Nom *</label>
                    <input type="text" id="beerName" required 
                           class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition"
                           placeholder="Ex: Triple Karmeliet">
                </div>
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Type *</label>
                    <select id="beerType" required 
                            class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition">
                        <option value="">Choisir...</option>
                        <optgroup label="Ales">
                            <option value="IPA">IPA (India Pale Ale)</option>
                            <option value="Pale Ale">Pale Ale</option>
                            <option value="Amber Ale">Amber Ale</option>
                            <option value="Brown Ale">Brown Ale</option>
                            <option value="Red Ale">Red Ale</option>
                        </optgroup>
                        <optgroup label="Blondes & Blanches">
                            <option value="Blonde">Blonde</option>
                            <option value="Blanche">Blanche / Witbier</option>
                            <option value="Weizen">Weizen</option>
                        </optgroup>
                        <optgroup label="Ambr√©es & Brunes">
                            <option value="Ambr√©e">Ambr√©e</option>
                            <option value="Brune">Brune</option>
                            <option value="Stout">Stout</option>
                            <option value="Porter">Porter</option>
                        </optgroup>
                        <optgroup label="Belges">
                            <option value="Triple">Triple</option>
                            <option value="Dubbel">Dubbel</option>
                            <option value="Quadrupel">Quadrupel</option>
                            <option value="Saison">Saison</option>
                            <option value="Abbaye">Abbaye</option>
                            <option value="Trappiste">Trappiste</option>
                        </optgroup>
                        <optgroup label="Lagers">
                            <option value="Lager">Lager</option>
                            <option value="Pilsner">Pilsner</option>
                            <option value="Bock">Bock</option>
                            <option value="Dunkel">Dunkel</option>
                        </optgroup>
                        <optgroup label="Sp√©cialit√©s">
                            <option value="Sour">Sour / Lambic</option>
                            <option value="Gueuze">Gueuze</option>
                            <option value="Kriek">Kriek</option>
                            <option value="Fruit√©e">Fruit√©e</option>
                            <option value="Fum√©e">Fum√©e</option>
                            <option value="Barley Wine">Barley Wine</option>
                        </optgroup>
                        <optgroup label="Sans alcool">
                            <option value="Sans alcool">Sans alcool</option>
                        </optgroup>
                        <option value="Autre">Autre</option>
                    </select>
                </div>
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Degr√© (%)</label>
                    <input type="number" id="beerABV" step="0.1" min="0" max="20"
                           class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition"
                           placeholder="Ex: 6.5">
                </div>
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Stock 33cl</label>
                    <input type="number" id="stock33cl" min="0" value="0" required 
                           class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition">
                </div>
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Stock 75cl</label>
                    <input type="number" id="stock75cl" min="0" value="0" required 
                           class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition">
                </div>
                <div>
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Origine</label>
                    <input type="text" id="beerOrigin"
                           class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition"
                           placeholder="Ex: Belgique">
                </div>
                <div class="md:col-span-2 lg:col-span-3">
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Photo de la bi√®re</label>
                    <div class="file-upload-wrapper">
                        <input type="file" id="beerPhoto" accept="image/*" onchange="previewImage(event)">
                        <label for="beerPhoto" id="photoLabel" class="file-upload-label">
                            <i class="fas fa-camera text-2xl text-gray-400 mb-2"></i>
                            <p class="text-sm text-gray-600">Cliquez pour ajouter une photo</p>
                        </label>
                    </div>
                    <img id="photoPreview" class="image-upload-preview hidden">
                </div>
                <div class="md:col-span-2 lg:col-span-3">
                    <label class="block text-sm font-semibold text-gray-700 mb-2">Description</label>
                    <textarea id="beerDescription" rows="2"
                              class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition"
                              placeholder="Notes de d√©gustation, ar√¥mes..."></textarea>
                </div>
                <div class="md:col-span-2 lg:col-span-3">
                    <button type="submit" 
                            class="w-full btn-primary text-white font-bold py-3 px-6 rounded-lg">
                        <i class="fas fa-plus"></i> Ajouter √† ma collection
                    </button>
                </div>
            </form>
        </div>

        <!-- Recherche et filtres -->
        <div class="card p-4 mb-6">
            <div class="flex flex-col md:flex-row gap-4">
                <input type="text" id="searchInput" 
                       class="flex-1 px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition"
                       placeholder="üîç Rechercher une bi√®re...">
                <select id="filterType" 
                        class="md:w-48 px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition">
                    <option value="">Tous les types</option>
                    <optgroup label="Ales">
                        <option value="IPA">IPA</option>
                        <option value="Pale Ale">Pale Ale</option>
                        <option value="Amber Ale">Amber Ale</option>
                        <option value="Brown Ale">Brown Ale</option>
                        <option value="Red Ale">Red Ale</option>
                    </optgroup>
                    <optgroup label="Blondes & Blanches">
                        <option value="Blonde">Blonde</option>
                        <option value="Blanche">Blanche</option>
                        <option value="Weizen">Weizen</option>
                    </optgroup>
                    <optgroup label="Ambr√©es & Brunes">
                        <option value="Ambr√©e">Ambr√©e</option>
                        <option value="Brune">Brune</option>
                        <option value="Stout">Stout</option>
                        <option value="Porter">Porter</option>
                    </optgroup>
                    <optgroup label="Belges">
                        <option value="Triple">Triple</option>
                        <option value="Dubbel">Dubbel</option>
                        <option value="Quadrupel">Quadrupel</option>
                        <option value="Saison">Saison</option>
                        <option value="Abbaye">Abbaye</option>
                        <option value="Trappiste">Trappiste</option>
                    </optgroup>
                    <optgroup label="Lagers">
                        <option value="Lager">Lager</option>
                        <option value="Pilsner">Pilsner</option>
                        <option value="Bock">Bock</option>
                        <option value="Dunkel">Dunkel</option>
                    </optgroup>
                    <optgroup label="Sp√©cialit√©s">
                        <option value="Sour">Sour / Lambic</option>
                        <option value="Gueuze">Gueuze</option>
                        <option value="Kriek">Kriek</option>
                        <option value="Fruit√©e">Fruit√©e</option>
                        <option value="Fum√©e">Fum√©e</option>
                        <option value="Barley Wine">Barley Wine</option>
                    </optgroup>
                    <optgroup label="Sans alcool">
                        <option value="Sans alcool">Sans alcool</option>
                    </optgroup>
                    <option value="Autre">Autre</option>
                </select>
            </div>
        </div>

        <!-- Liste des bi√®res -->
        <div id="beerList" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        </div>

        <!-- Message vide -->
        <div id="emptyMessage" class="card p-12 text-center">
            <i class="fas fa-beer text-6xl text-gray-300 mb-4"></i>
            <p class="text-2xl font-semibold text-gray-600 mb-2">Votre cave est vide</p>
            <p class="text-gray-500">Ajoutez votre premi√®re bi√®re pour commencer !</p>
        </div>
    </div>

    <!-- Modal GitHub -->
    <div id="githubModal" class="fixed inset-0 modal-backdrop hidden items-center justify-center z-50 p-4" onclick="if(event.target === this) closeGitHubGuide()">
        <div class="bg-white rounded-2xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto">
            <div class="gradient-header text-white p-6 rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <h2 class="text-2xl font-bold">
                        <i class="fab fa-github"></i> Publier sur GitHub Pages
                    </h2>
                    <button onclick="closeGitHubGuide()" class="text-3xl hover:text-gray-200">&times;</button>
                </div>
            </div>
            <div class="p-6 md:p-8 space-y-6">
                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded">
                    <h3 class="font-bold text-lg mb-2">üìã Deux fa√ßons de sauvegarder</h3>
                    <div class="space-y-3 text-sm text-gray-700">
                        <div class="bg-white p-3 rounded border border-blue-200">
                            <strong class="text-blue-700">üöÄ AUTOMATIQUE (Recommand√©)</strong>
                            <ul class="list-disc list-inside mt-1 ml-2 space-y-1">
                                <li>Configurez une fois votre token GitHub</li>
                                <li>Cliquez sur "Sauvegarder sur GitHub" quand vous voulez</li>
                                <li>Votre collection est automatiquement upload√©e !</li>
                            </ul>
                        </div>
                        <div class="bg-white p-3 rounded border border-gray-300">
                            <strong class="text-gray-700">üì• MANUELLE (Alternative)</strong>
                            <ul class="list-disc list-inside mt-1 ml-2 space-y-1">
                                <li>T√©l√©chargez le fichier de sauvegarde</li>
                                <li>Uploadez-le manuellement sur GitHub</li>
                            </ul>
                        </div>
                    </div>
                </div>

                <div class="bg-purple-50 border-l-4 border-purple-500 p-4 rounded">
                    <h3 class="font-bold text-lg mb-2 text-purple-800">ü§ñ Configuration de la sauvegarde automatique</h3>
                    <ol class="list-decimal list-inside text-sm text-gray-700 space-y-2">
                        <li>Cr√©ez un d√©p√¥t GitHub public (ex: "ma-cave-a-bieres")</li>
                        <li>Cr√©ez un token d'acc√®s : <a href="https://github.com/settings/tokens" target="_blank" class="text-purple-600 hover:underline font-semibold">github.com/settings/tokens</a>
                            <ul class="list-disc list-inside ml-6 mt-1 text-xs">
                                <li>Cliquez "Generate new token (classic)"</li>
                                <li>Cochez la permission <strong>repo</strong></li>
                                <li>Copiez le token g√©n√©r√©</li>
                            </ul>
                        </li>
                        <li>Cliquez sur le bouton violet <strong>"Configurer GitHub"</strong></li>
                        <li>Entrez vos identifiants (username, repo, token)</li>
                        <li>Cliquez sur <strong>"Sauvegarder sur GitHub"</strong> √† tout moment !</li>
                    </ol>
                </div>

                <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                    <h3 class="font-bold text-lg mb-2">üíæ Sauvegarde manuelle (sans token)</h3>
                    <ol class="list-decimal list-inside text-sm text-gray-700 space-y-1">
                        <li>Cliquez sur <strong>"T√©l√©charger sauvegarde"</strong></li>
                        <li>Uploadez le fichier <code class="bg-gray-100 px-2 py-1 rounded">sauvegarde-cave-bieres-XXXX.json</code> sur votre d√©p√¥t GitHub</li>
                        <li>Vos donn√©es sont sauvegard√©es et versionn√©es !</li>
                        <li>Pour restaurer : t√©l√©chargez le fichier depuis GitHub, puis cliquez sur "Restaurer sauvegarde"</li>
                    </ol>
                </div>

                <div class="space-y-6">
                    <h3 class="font-bold text-xl text-gray-800 border-b-2 border-purple-500 pb-2">
                        üì§ Publier votre vitrine sur GitHub Pages
                    </h3>

                    <div class="flex gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-purple-600 text-white rounded-full flex items-center justify-center font-bold text-lg">1</div>
                        <div class="flex-1">
                            <h4 class="font-bold text-lg mb-2">Cr√©er un d√©p√¥t GitHub</h4>
                            <p class="text-gray-600 mb-2">Allez sur <a href="https://github.com/new" target="_blank" class="text-purple-600 hover:underline font-semibold">github.com/new</a></p>
                            <ul class="list-disc list-inside text-gray-600 space-y-1">
                                <li>Nom du d√©p√¥t : <code class="bg-gray-100 px-2 py-1 rounded">ma-cave-a-bieres</code></li>
                                <li>Cochez "Public"</li>
                                <li>Cliquez sur "Create repository"</li>
                            </ul>
                        </div>
                    </div>

                    <div class="flex gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-purple-600 text-white rounded-full flex items-center justify-center font-bold text-lg">2</div>
                        <div class="flex-1">
                            <h4 class="font-bold text-lg mb-2">Exporter votre vitrine</h4>
                            <p class="text-gray-600 mb-2">Cliquez sur le bouton vert <strong>"Exporter vitrine GitHub"</strong></p>
                            <p class="text-sm text-gray-500">Cela t√©l√©charge <code class="bg-gray-100 px-2 py-1 rounded">vitrine.html</code> avec toutes vos bi√®res et photos</p>
                        </div>
                    </div>

                    <div class="flex gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-purple-600 text-white rounded-full flex items-center justify-center font-bold text-lg">3</div>
                        <div class="flex-1">
                            <h4 class="font-bold text-lg mb-2">Uploader sur GitHub</h4>
                            <p class="text-gray-600 mb-2">Dans votre d√©p√¥t :</p>
                            <ul class="list-disc list-inside text-gray-600 space-y-1">
                                <li>Cliquez sur "Add file" ‚Üí "Upload files"</li>
                                <li>Glissez-d√©posez <code class="bg-gray-100 px-2 py-1 rounded">vitrine.html</code></li>
                                <li><strong>Important :</strong> Renommez-le en <code class="bg-gray-100 px-2 py-1 rounded">index.html</code></li>
                                <li>Optionnel : Ajoutez aussi votre fichier de sauvegarde JSON</li>
                                <li>Cliquez sur "Commit changes"</li>
                            </ul>
                        </div>
                    </div>

                    <div class="flex gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-purple-600 text-white rounded-full flex items-center justify-center font-bold text-lg">4</div>
                        <div class="flex-1">
                            <h4 class="font-bold text-lg mb-2">Activer GitHub Pages</h4>
                            <ul class="list-disc list-inside text-gray-600 space-y-1">
                                <li>Allez dans "Settings" ‚Üí "Pages"</li>
                                <li>Source : s√©lectionnez "Deploy from a branch"</li>
                                <li>Branch : s√©lectionnez "main" ‚Üí "/ (root)"</li>
                                <li>Cliquez sur "Save"</li>
                            </ul>
                        </div>
                    </div>

                    <div class="flex gap-4">
                        <div class="flex-shrink-0 w-10 h-10 bg-green-600 text-white rounded-full flex items-center justify-center font-bold text-lg">‚úì</div>
                        <div class="flex-1">
                            <h4 class="font-bold text-lg mb-2">C'est en ligne !</h4>
                            <p class="text-gray-600 mb-2">Votre vitrine sera accessible √† :</p>
                            <code class="block bg-gray-100 px-4 py-3 rounded-lg">https://VOTRE-USERNAME.github.io/ma-cave-a-bieres/</code>
                        </div>
                    </div>
                </div>

                <div class="bg-green-50 border-l-4 border-green-500 p-4 rounded">
                    <p class="font-semibold text-green-800 mb-1">‚úÖ Workflow recommand√©</p>
                    <ol class="text-green-700 text-sm space-y-1 list-decimal list-inside">
                        <li>Configurez une fois votre token GitHub (bouton violet)</li>
                        <li>G√©rez votre collection dans cette page</li>
                        <li>Cliquez sur <strong>"Sauvegarder sur GitHub"</strong> r√©guli√®rement</li>
                        <li>Exportez la <strong>vitrine publique</strong> quand vous voulez mettre √† jour votre site</li>
                        <li>En cas de probl√®me : cliquez sur "Restaurer sauvegarde" et s√©lectionnez votre fichier depuis GitHub</li>
                    </ol>
                </div>

                <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded">
                    <p class="font-semibold text-red-800 mb-1">‚ö†Ô∏è Important</p>
                    <p class="text-red-700 text-sm">Les donn√©es sont stock√©es localement dans votre navigateur. Sans sauvegarde sur GitHub, vous perdrez tout si vous changez de navigateur ou effacez vos donn√©es.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal Configuration GitHub -->
    <div id="githubConfigModal" class="fixed inset-0 modal-backdrop hidden items-center justify-center z-50 p-4" onclick="if(event.target === this) closeGitHubConfig()">
        <div class="bg-white rounded-2xl shadow-2xl max-w-2xl w-full">
            <div class="gradient-header text-white p-6 rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <h2 class="text-2xl font-bold">
                        <i class="fas fa-cog"></i> Configuration GitHub
                    </h2>
                    <button onclick="closeGitHubConfig()" class="text-3xl hover:text-gray-200">&times;</button>
                </div>
            </div>
            <div class="p-6 md:p-8">
                <div class="bg-blue-50 border-l-4 border-blue-500 p-4 rounded mb-6">
                    <h3 class="font-bold text-blue-800 mb-2">üîê Sauvegarde automatique sur GitHub</h3>
                    <p class="text-sm text-blue-700">Configurez vos identifiants GitHub pour sauvegarder automatiquement votre collection dans votre d√©p√¥t.</p>
                </div>

                <form id="githubConfigForm" class="space-y-4">
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-user"></i> Nom d'utilisateur GitHub *
                        </label>
                        <input type="text" id="githubUsername" required 
                               class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition"
                               placeholder="Ex: votre-username">
                    </div>

                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-folder"></i> Nom du d√©p√¥t *
                        </label>
                        <input type="text" id="githubRepo" required 
                               class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition"
                               placeholder="Ex: ma-cave-a-bieres">
                    </div>

                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">
                            <i class="fas fa-key"></i> Token d'acc√®s personnel (PAT) *
                        </label>
                        <input type="password" id="githubToken" required 
                               class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition"
                               placeholder="ghp_xxxxxxxxxxxxxxxxxxxx">
                        <p class="text-xs text-gray-500 mt-1">
                            Le token restera stock√© localement dans votre navigateur
                        </p>
                    </div>

                    <div class="bg-yellow-50 border-l-4 border-yellow-500 p-4 rounded">
                        <h4 class="font-bold text-yellow-800 mb-2">üìù Comment cr√©er un token ?</h4>
                        <ol class="text-sm text-yellow-700 space-y-1 list-decimal list-inside">
                            <li>Allez sur <a href="https://github.com/settings/tokens" target="_blank" class="underline font-semibold">github.com/settings/tokens</a></li>
                            <li>Cliquez sur "Generate new token" ‚Üí "Generate new token (classic)"</li>
                            <li>Donnez un nom : "Cave √† Bi√®res"</li>
                            <li>Cochez la permission : <strong>repo</strong> (acc√®s complet aux d√©p√¥ts)</li>
                            <li>Cliquez sur "Generate token"</li>
                            <li>Copiez le token (vous ne pourrez plus le voir apr√®s !)</li>
                        </ol>
                    </div>

                    <div class="flex gap-3">
                        <button type="submit" class="flex-1 btn-primary text-white font-bold py-3 px-6 rounded-lg">
                            <i class="fas fa-save"></i> Enregistrer la configuration
                        </button>
                        <button type="button" onclick="clearGitHubConfig()" class="bg-red-500 hover:bg-red-600 text-white font-bold py-3 px-6 rounded-lg transition">
                            <i class="fas fa-trash"></i> Effacer
                        </button>
                    </div>
                </form>

                <div class="bg-red-50 border-l-4 border-red-500 p-4 rounded mt-6">
                    <p class="font-bold text-red-800 mb-1">‚ö†Ô∏è S√©curit√©</p>
                    <p class="text-sm text-red-700">Votre token est stock√© localement dans votre navigateur. Ne partagez jamais votre token avec personne. Si vous utilisez un ordinateur public, pensez √† effacer la configuration apr√®s utilisation.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Modal √âdition de bi√®re -->
    <div id="editBeerModal" class="fixed inset-0 modal-backdrop hidden items-center justify-center z-50 p-4" onclick="if(event.target === this) closeEditBeer()">
        <div class="bg-white rounded-2xl shadow-2xl max-w-3xl w-full max-h-[90vh] overflow-y-auto">
            <div class="gradient-header text-white p-6 rounded-t-2xl">
                <div class="flex justify-between items-center">
                    <h2 class="text-2xl font-bold">
                        <i class="fas fa-edit"></i> Modifier la bi√®re
                    </h2>
                    <button onclick="closeEditBeer()" class="text-3xl hover:text-gray-200">&times;</button>
                </div>
            </div>
            <div class="p-6 md:p-8">
                <form id="editBeerForm" class="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <input type="hidden" id="editBeerIndex">
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Nom *</label>
                        <input type="text" id="editBeerName" required 
                               class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition"
                               placeholder="Ex: Triple Karmeliet">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Type *</label>
                        <select id="editBeerType" required 
                                class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition">
                            <option value="">Choisir...</option>
                            <optgroup label="Ales">
                                <option value="IPA">IPA (India Pale Ale)</option>
                                <option value="Pale Ale">Pale Ale</option>
                                <option value="Amber Ale">Amber Ale</option>
                                <option value="Brown Ale">Brown Ale</option>
                                <option value="Red Ale">Red Ale</option>
                            </optgroup>
                            <optgroup label="Blondes & Blanches">
                                <option value="Blonde">Blonde</option>
                                <option value="Blanche">Blanche / Witbier</option>
                                <option value="Weizen">Weizen</option>
                            </optgroup>
                            <optgroup label="Ambr√©es & Brunes">
                                <option value="Ambr√©e">Ambr√©e</option>
                                <option value="Brune">Brune</option>
                                <option value="Stout">Stout</option>
                                <option value="Porter">Porter</option>
                            </optgroup>
                            <optgroup label="Belges">
                                <option value="Triple">Triple</option>
                                <option value="Dubbel">Dubbel</option>
                                <option value="Quadrupel">Quadrupel</option>
                                <option value="Saison">Saison</option>
                                <option value="Abbaye">Abbaye</option>
                                <option value="Trappiste">Trappiste</option>
                            </optgroup>
                            <optgroup label="Lagers">
                                <option value="Lager">Lager</option>
                                <option value="Pilsner">Pilsner</option>
                                <option value="Bock">Bock</option>
                                <option value="Dunkel">Dunkel</option>
                            </optgroup>
                            <optgroup label="Sp√©cialit√©s">
                                <option value="Sour">Sour / Lambic</option>
                                <option value="Gueuze">Gueuze</option>
                                <option value="Kriek">Kriek</option>
                                <option value="Fruit√©e">Fruit√©e</option>
                                <option value="Fum√©e">Fum√©e</option>
                                <option value="Barley Wine">Barley Wine</option>
                            </optgroup>
                            <optgroup label="Sans alcool">
                                <option value="Sans alcool">Sans alcool</option>
                            </optgroup>
                            <option value="Autre">Autre</option>
                        </select>
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Degr√© (%)</label>
                        <input type="number" id="editBeerABV" step="0.1" min="0" max="20"
                               class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition"
                               placeholder="Ex: 6.5">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Stock 33cl</label>
                        <input type="number" id="editStock33cl" min="0" value="0" required 
                               class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Stock 75cl</label>
                        <input type="number" id="editStock75cl" min="0" value="0" required 
                               class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition">
                    </div>
                    
                    <div>
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Origine</label>
                        <input type="text" id="editBeerOrigin"
                               class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition"
                               placeholder="Ex: Belgique">
                    </div>
                    
                    <div class="md:col-span-2">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Photo de la bi√®re</label>
                        <div class="mb-3" id="currentPhotoContainer" style="display: none;">
                            <p class="text-sm text-gray-600 mb-2">Photo actuelle :</p>
                            <img id="editCurrentPhoto" class="w-48 h-32 object-cover rounded-lg border-2 border-gray-200">
                        </div>
                        <div class="file-upload-wrapper">
                            <input type="file" id="editBeerPhoto" accept="image/*" onchange="previewEditImage(event)">
                            <label for="editBeerPhoto" id="editPhotoLabel" class="file-upload-label">
                                <i class="fas fa-camera text-2xl text-gray-400 mb-2"></i>
                                <p class="text-sm text-gray-600">Cliquez pour changer la photo</p>
                            </label>
                        </div>
                        <img id="editPhotoPreview" class="image-upload-preview hidden">
                        <button type="button" onclick="removeEditPhoto()" id="removePhotoBtn" class="mt-2 text-sm text-red-600 hover:text-red-800" style="display: none;">
                            <i class="fas fa-times"></i> Supprimer la photo
                        </button>
                    </div>
                    
                    <div class="md:col-span-2">
                        <label class="block text-sm font-semibold text-gray-700 mb-2">Description</label>
                        <textarea id="editBeerDescription" rows="3"
                                  class="w-full px-4 py-2 border-2 border-gray-200 rounded-lg focus:border-purple-500 focus:ring-2 focus:ring-purple-200 outline-none transition"
                                  placeholder="Notes de d√©gustation, ar√¥mes..."></textarea>
                    </div>
                    
                    <div class="md:col-span-2 flex gap-3">
                        <button type="submit" 
                                class="flex-1 btn-primary text-white font-bold py-3 px-6 rounded-lg">
                            <i class="fas fa-save"></i> Enregistrer les modifications
                        </button>
                        <button type="button" onclick="closeEditBeer()" 
                                class="bg-gray-300 hover:bg-gray-400 text-gray-800 font-bold py-3 px-6 rounded-lg transition">
                            Annuler
                        </button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script>
        let beers = JSON.parse(localStorage.getItem('beers')) || [];
        let filteredBeers = [...beers];
        let currentPhotoBase64 = null;

        // Fonction pour compresser les images
        function compressImage(base64String, maxWidth = 800, quality = 0.7) {
            return new Promise((resolve, reject) => {
                const img = new Image();
                img.onload = function() {
                    const canvas = document.createElement('canvas');
                    let width = img.width;
                    let height = img.height;
                    
                    // Redimensionner si n√©cessaire
                    if (width > maxWidth) {
                        height = (height * maxWidth) / width;
                        width = maxWidth;
                    }
                    
                    canvas.width = width;
                    canvas.height = height;
                    
                    const ctx = canvas.getContext('2d');
                    ctx.drawImage(img, 0, 0, width, height);
                    
                    // Convertir en JPEG avec compression
                    const compressedBase64 = canvas.toDataURL('image/jpeg', quality);
                    resolve(compressedBase64);
                };
                img.onerror = reject;
                img.src = base64String;
            });
        }

        function saveBeers() {
            try {
                localStorage.setItem('beers', JSON.stringify(beers));
                updateStats();
            } catch (e) {
                if (e.name === 'QuotaExceededError') {
                    // Calculer la taille utilis√©e
                    const sizeInMB = (JSON.stringify(beers).length / (1024 * 1024)).toFixed(2);
                    
                    showNotification('‚ö†Ô∏è Espace de stockage insuffisant (' + sizeInMB + ' MB)', 'error');
                    
                    // Proposer des solutions
                    const choice = confirm(
                        'Votre collection est trop volumineuse pour le stockage local (' + sizeInMB + ' MB).\n\n' +
                        'Solutions :\n' +
                        '1. Sauvegarder sur GitHub (recommand√©)\n' +
                        '2. T√©l√©charger une sauvegarde JSON\n' +
                        '3. Supprimer des photos\n\n' +
                        'Voulez-vous sauvegarder sur GitHub maintenant ?'
                    );
                    
                    if (choice) {
                        saveToGitHub();
                    } else {
                        exportBackup();
                    }
                    
                    // Annuler la derni√®re modification
                    beers = JSON.parse(localStorage.getItem('beers')) || [];
                    displayBeers();
                } else {
                    console.error('Erreur de sauvegarde:', e);
                    showNotification('Erreur lors de la sauvegarde : ' + e.message, 'error');
                }
            }
        }

        function updateStats() {
            const total33 = beers.reduce((sum, beer) => sum + beer.stock33cl, 0);
            const total75 = beers.reduce((sum, beer) => sum + beer.stock75cl, 0);
            const totalLiters = ((total33 * 0.33) + (total75 * 0.75)).toFixed(1);
            
            document.getElementById('totalBeers').textContent = beers.length;
            document.getElementById('total33cl').textContent = total33;
            document.getElementById('total75cl').textContent = total75;
            document.getElementById('totalLiters').textContent = totalLiters;
            
            // Calculer l'espace utilis√©
            try {
                const dataSize = JSON.stringify(beers).length;
                const sizeInKB = (dataSize / 1024).toFixed(0);
                const sizeInMB = (dataSize / (1024 * 1024)).toFixed(2);
                const maxSize = 5; // Limite approximative en MB
                const percentage = ((dataSize / (maxSize * 1024 * 1024)) * 100).toFixed(0);
                
                // Afficher un avertissement si > 70%
                if (percentage > 70) {
                    console.warn('Stockage √† ' + percentage + '% (' + sizeInMB + ' MB / ~' + maxSize + ' MB)');
                    if (percentage > 90) {
                        showNotification('‚ö†Ô∏è Stockage presque plein (' + percentage + '%). Sauvegardez sur GitHub !', 'error');
                    }
                }
            } catch (e) {
                console.error('Erreur calcul espace:', e);
            }
        }

        async function compressAllPhotos() {
            if (!confirm('Voulez-vous compresser toutes les photos pour r√©duire l\'espace utilis√© ?\n\nCela peut prendre quelques secondes.')) {
                return;
            }
            
            showNotification('Compression en cours...', 'success');
            let compressed = 0;
            
            for (let i = 0; i < beers.length; i++) {
                if (beers[i].photo) {
                    try {
                        const original = beers[i].photo;
                        const compressedPhoto = await compressImage(original, 800, 0.7);
                        
                        // Ne remplacer que si la compression r√©duit vraiment la taille
                        if (compressedPhoto.length < original.length * 0.9) {
                            beers[i].photo = compressedPhoto;
                            compressed++;
                        }
                    } catch (e) {
                        console.error('Erreur compression bi√®re ' + i, e);
                    }
                }
            }
            
            if (compressed > 0) {
                try {
                    localStorage.setItem('beers', JSON.stringify(beers));
                    showNotification('‚úÖ ' + compressed + ' photo(s) compress√©e(s) !', 'success');
                    displayBeers();
                } catch (e) {
                    showNotification('‚ùå Erreur : toujours trop volumineux. Supprimez des photos.', 'error');
                }
            } else {
                showNotification('Aucune compression n√©cessaire', 'success');
            }
        }

        function showNotification(message, type = 'success') {
            const notification = document.createElement('div');
            const bgColor = type === 'success' ? 'bg-green-500' : 'bg-red-500';
            notification.className = 'notification ' + bgColor + ' text-white px-6 py-4 rounded-lg shadow-xl flex items-center gap-3';
            notification.innerHTML = '<i class="fas fa-' + (type === 'success' ? 'check-circle' : 'exclamation-circle') + ' text-xl"></i><span class="font-semibold">' + message + '</span>';
            document.getElementById('notifications').appendChild(notification);
            setTimeout(() => notification.remove(), 3000);
        }

        function previewImage(event) {
            const file = event.target.files[0];
            if (file) {
                // V√©rifier la taille du fichier
                const fileSizeInMB = file.size / (1024 * 1024);
                
                const reader = new FileReader();
                reader.onload = async function(e) {
                    let imageData = e.target.result;
                    
                    // Compresser automatiquement les images > 100 KB
                    if (fileSizeInMB > 0.1) {
                        try {
                            showNotification('Compression de l\'image en cours...', 'success');
                            imageData = await compressImage(imageData, 800, 0.7);
                            const originalSize = (e.target.result.length / 1024).toFixed(0);
                            const compressedSize = (imageData.length / 1024).toFixed(0);
                            showNotification('Image compress√©e : ' + originalSize + ' KB ‚Üí ' + compressedSize + ' KB', 'success');
                        } catch (err) {
                            console.error('Erreur de compression:', err);
                            showNotification('Erreur lors de la compression de l\'image', 'error');
                            return;
                        }
                    }
                    
                    currentPhotoBase64 = imageData;
                    const preview = document.getElementById('photoPreview');
                    preview.src = currentPhotoBase64;
                    preview.classList.remove('hidden');
                    document.getElementById('photoLabel').classList.add('has-file');
                    document.getElementById('photoLabel').innerHTML = '<i class="fas fa-check-circle text-2xl text-green-500 mb-2"></i><p class="text-sm text-green-600 font-semibold">Photo s√©lectionn√©e</p>';
                }
                reader.readAsDataURL(file);
            }
        }

        function getTypeColor(type) {
            const colors = {
                // Ales
                'IPA': 'bg-orange-500',
                'Pale Ale': 'bg-orange-400',
                'Amber Ale': 'bg-orange-600',
                'Brown Ale': 'bg-amber-700',
                'Red Ale': 'bg-red-600',
                
                // Blondes & Blanches
                'Blonde': 'bg-yellow-400',
                'Blanche': 'bg-blue-400',
                'Weizen': 'bg-yellow-300',
                
                // Ambr√©es & Brunes
                'Ambr√©e': 'bg-orange-600',
                'Brune': 'bg-amber-800',
                'Stout': 'bg-gray-800',
                'Porter': 'bg-amber-900',
                
                // Belges
                'Triple': 'bg-yellow-500',
                'Dubbel': 'bg-amber-700',
                'Quadrupel': 'bg-amber-900',
                'Saison': 'bg-green-400',
                'Abbaye': 'bg-amber-600',
                'Trappiste': 'bg-amber-700',
                
                // Lagers
                'Lager': 'bg-yellow-300',
                'Pilsner': 'bg-yellow-400',
                'Bock': 'bg-amber-600',
                'Dunkel': 'bg-amber-800',
                
                // Sp√©cialit√©s
                'Sour': 'bg-pink-400',
                'Gueuze': 'bg-pink-500',
                'Kriek': 'bg-red-500',
                'Fruit√©e': 'bg-rose-400',
                'Fum√©e': 'bg-gray-700',
                'Barley Wine': 'bg-red-700',
                
                // Sans alcool
                'Sans alcool': 'bg-green-500'
            };
            return colors[type] || 'bg-purple-500';
        }

        function escapeHtml(text) {
            if (!text) return '';
            const map = {
                '&': '&amp;',
                '<': '&lt;',
                '>': '&gt;',
                '"': '&quot;',
                "'": '&#039;'
            };
            return text.toString().replace(/[&<>"']/g, function(m) { return map[m]; });
        }

        function displayBeers() {
            const beerList = document.getElementById('beerList');
            const emptyMessage = document.getElementById('emptyMessage');
            
            if (filteredBeers.length === 0) {
                beerList.innerHTML = '';
                emptyMessage.style.display = 'block';
                return;
            }

            emptyMessage.style.display = 'none';
            beerList.innerHTML = filteredBeers.map((beer, index) => {
                const originalIndex = beers.findIndex(b => b === beer);
                const totalStock = beer.stock33cl + beer.stock75cl;
                const stockClass = totalStock === 0 ? 'stock-empty' : totalStock < 5 ? 'stock-low' : 'stock-ok';
                const stockText = totalStock === 0 ? '‚ö†Ô∏è Rupture' : totalStock < 5 ? '‚ö° Stock faible' : '‚úì En stock';
                
                const safeName = escapeHtml(beer.name);
                const safeDescription = escapeHtml(beer.description);
                const safeOrigin = escapeHtml(beer.origin);
                const safeAbv = escapeHtml(beer.abv);
                
                return `
                <div class="card overflow-hidden">
                    ${beer.photo ? `
                        <img src="${beer.photo}" alt="${safeName}" class="beer-image">
                    ` : `
                        <div class="bg-gradient-to-br from-gray-100 to-gray-200 h-48 flex items-center justify-center">
                            <i class="fas fa-beer text-6xl text-gray-400"></i>
                        </div>
                    `}
                    
                    <div class="${getTypeColor(beer.type)} text-white p-5">
                        <div class="flex justify-between items-start mb-2">
                            <h3 class="text-xl font-bold">${safeName}</h3>
                            <span class="beer-type-badge ${stockClass}">${stockText}</span>
                        </div>
                        <div class="flex flex-wrap gap-2 text-sm">
                            <span class="bg-white bg-opacity-20 px-2 py-1 rounded">${beer.type}</span>
                            ${safeAbv ? `<span class="bg-white bg-opacity-20 px-2 py-1 rounded">${safeAbv}%</span>` : ''}
                            ${safeOrigin ? `<span class="bg-white bg-opacity-20 px-2 py-1 rounded"><i class="fas fa-map-marker-alt"></i> ${safeOrigin}</span>` : ''}
                        </div>
                    </div>
                    
                    <div class="p-5">
                        ${safeDescription ? `
                            <div class="mb-4 p-3 bg-gray-50 rounded-lg">
                                <p class="text-sm text-gray-700 italic">"${safeDescription}"</p>
                            </div>
                        ` : ''}
                        
                        <div class="mb-3 bg-blue-50 p-4 rounded-lg border border-blue-100">
                            <div class="flex items-center justify-between mb-3">
                                <span class="font-bold text-gray-700"><i class="fas fa-bottle-droplet text-blue-600"></i> 33cl</span>
                                <span class="text-2xl font-bold text-blue-600">${beer.stock33cl}</span>
                            </div>
                            <div class="grid grid-cols-4 gap-2">
                                <button onclick="updateStock(${originalIndex}, '33cl', -10)" 
                                        class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 rounded-lg transition text-sm">-10</button>
                                <button onclick="updateStock(${originalIndex}, '33cl', -1)" 
                                        class="bg-red-400 hover:bg-red-500 text-white font-bold py-2 rounded-lg transition">-1</button>
                                <button onclick="updateStock(${originalIndex}, '33cl', 1)" 
                                        class="bg-green-400 hover:bg-green-500 text-white font-bold py-2 rounded-lg transition">+1</button>
                                <button onclick="updateStock(${originalIndex}, '33cl', 10)" 
                                        class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 rounded-lg transition text-sm">+10</button>
                            </div>
                        </div>

                        <div class="mb-4 bg-purple-50 p-4 rounded-lg border border-purple-100">
                            <div class="flex items-center justify-between mb-3">
                                <span class="font-bold text-gray-700"><i class="fas fa-wine-bottle text-purple-600"></i> 75cl</span>
                                <span class="text-2xl font-bold text-purple-600">${beer.stock75cl}</span>
                            </div>
                            <div class="grid grid-cols-4 gap-2">
                                <button onclick="updateStock(${originalIndex}, '75cl', -10)" 
                                        class="bg-red-500 hover:bg-red-600 text-white font-bold py-2 rounded-lg transition text-sm">-10</button>
                                <button onclick="updateStock(${originalIndex}, '75cl', -1)" 
                                        class="bg-red-400 hover:bg-red-500 text-white font-bold py-2 rounded-lg transition">-1</button>
                                <button onclick="updateStock(${originalIndex}, '75cl', 1)" 
                                        class="bg-green-400 hover:bg-green-500 text-white font-bold py-2 rounded-lg transition">+1</button>
                                <button onclick="updateStock(${originalIndex}, '75cl', 10)" 
                                        class="bg-green-500 hover:bg-green-600 text-white font-bold py-2 rounded-lg transition text-sm">+10</button>
                            </div>
                        </div>

                        <button onclick="deleteBeer(${originalIndex})" 
                                class="w-full bg-gray-100 hover:bg-red-50 text-red-600 font-bold py-2 rounded-lg transition border-2 border-gray-200 hover:border-red-300">
                            <i class="fas fa-trash"></i> Supprimer
                        </button>
                        <button onclick="editBeer(${originalIndex})" 
                                class="w-full mt-2 bg-blue-100 hover:bg-blue-200 text-blue-700 font-bold py-2 rounded-lg transition border-2 border-blue-200 hover:border-blue-400">
                            <i class="fas fa-edit"></i> Modifier
                        </button>
                        <div class="grid grid-cols-2 gap-2 mt-2">
                            <button onclick="moveBeerUp(${originalIndex})" 
                                    ${originalIndex === 0 ? 'disabled' : ''}
                                    class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-2 rounded-lg transition border-2 border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed">
                                <i class="fas fa-arrow-up"></i> Monter
                            </button>
                            <button onclick="moveBeerDown(${originalIndex})" 
                                    ${originalIndex === beers.length - 1 ? 'disabled' : ''}
                                    class="bg-gray-200 hover:bg-gray-300 text-gray-700 font-bold py-2 rounded-lg transition border-2 border-gray-300 disabled:opacity-50 disabled:cursor-not-allowed">
                                <i class="fas fa-arrow-down"></i> Descendre
                            </button>
                        </div>
                    </div>
                </div>
            `}).join('');
        }

        function updateStock(index, size, change) {
            const stockKey = size === '33cl' ? 'stock33cl' : 'stock75cl';
            const newStock = beers[index][stockKey] + change;
            
            if (newStock >= 0) {
                beers[index][stockKey] = newStock;
                saveBeers();
                applyFilters();
                showNotification('Stock ' + size + ' : ' + (change > 0 ? '+' : '') + change);
            }
        }

        function deleteBeer(index) {
            if (confirm('Supprimer "' + beers[index].name + '" ?')) {
                const name = beers[index].name;
                beers.splice(index, 1);
                saveBeers();
                applyFilters();
                showNotification('"' + name + '" supprim√©e');
            }
        }

        function moveBeerUp(index) {
            if (index > 0) {
                // √âchanger avec la bi√®re pr√©c√©dente
                const temp = beers[index];
                beers[index] = beers[index - 1];
                beers[index - 1] = temp;
                
                saveBeers();
                applyFilters();
                showNotification('Bi√®re d√©plac√©e vers le haut');
            }
        }

        function moveBeerDown(index) {
            if (index < beers.length - 1) {
                // √âchanger avec la bi√®re suivante
                const temp = beers[index];
                beers[index] = beers[index + 1];
                beers[index + 1] = temp;
                
                saveBeers();
                applyFilters();
                showNotification('Bi√®re d√©plac√©e vers le bas');
            }
        }

        let editPhotoBase64 = null;
        let keepCurrentPhoto = true;

        function editBeer(index) {
            const beer = beers[index];
            
            // Remplir le formulaire
            document.getElementById('editBeerIndex').value = index;
            document.getElementById('editBeerName').value = beer.name;
            document.getElementById('editBeerType').value = beer.type;
            document.getElementById('editBeerABV').value = beer.abv || '';
            document.getElementById('editStock33cl').value = beer.stock33cl;
            document.getElementById('editStock75cl').value = beer.stock75cl;
            document.getElementById('editBeerOrigin').value = beer.origin || '';
            document.getElementById('editBeerDescription').value = beer.description || '';
            
            // G√©rer la photo
            editPhotoBase64 = null;
            keepCurrentPhoto = true;
            
            if (beer.photo) {
                document.getElementById('currentPhotoContainer').style.display = 'block';
                document.getElementById('editCurrentPhoto').src = beer.photo;
                document.getElementById('removePhotoBtn').style.display = 'block';
            } else {
                document.getElementById('currentPhotoContainer').style.display = 'none';
                document.getElementById('removePhotoBtn').style.display = 'none';
            }
            
            document.getElementById('editPhotoPreview').classList.add('hidden');
            document.getElementById('editPhotoLabel').classList.remove('has-file');
            document.getElementById('editPhotoLabel').innerHTML = '<i class="fas fa-camera text-2xl text-gray-400 mb-2"></i><p class="text-sm text-gray-600">Cliquez pour changer la photo</p>';
            
            // Ouvrir la modal
            document.getElementById('editBeerModal').classList.remove('hidden');
            document.getElementById('editBeerModal').classList.add('flex');
        }

        function closeEditBeer() {
            document.getElementById('editBeerModal').classList.add('hidden');
            document.getElementById('editBeerModal').classList.remove('flex');
            document.getElementById('editBeerForm').reset();
            editPhotoBase64 = null;
            keepCurrentPhoto = true;
        }

        function previewEditImage(event) {
            const file = event.target.files[0];
            if (file) {
                const fileSizeInMB = file.size / (1024 * 1024);
                
                const reader = new FileReader();
                reader.onload = async function(e) {
                    let imageData = e.target.result;
                    
                    // Compresser automatiquement les images > 100 KB
                    if (fileSizeInMB > 0.1) {
                        try {
                            showNotification('Compression de l\'image en cours...', 'success');
                            imageData = await compressImage(imageData, 800, 0.7);
                            const originalSize = (e.target.result.length / 1024).toFixed(0);
                            const compressedSize = (imageData.length / 1024).toFixed(0);
                            showNotification('Image compress√©e : ' + originalSize + ' KB ‚Üí ' + compressedSize + ' KB', 'success');
                        } catch (err) {
                            console.error('Erreur de compression:', err);
                            showNotification('Erreur lors de la compression de l\'image', 'error');
                            return;
                        }
                    }
                    
                    editPhotoBase64 = imageData;
                    keepCurrentPhoto = false;
                    const preview = document.getElementById('editPhotoPreview');
                    preview.src = editPhotoBase64;
                    preview.classList.remove('hidden');
                    document.getElementById('editPhotoLabel').classList.add('has-file');
                    document.getElementById('editPhotoLabel').innerHTML = '<i class="fas fa-check-circle text-2xl text-green-500 mb-2"></i><p class="text-sm text-green-600 font-semibold">Nouvelle photo s√©lectionn√©e</p>';
                }
                reader.readAsDataURL(file);
            }
        }

        function removeEditPhoto() {
            if (confirm('Voulez-vous vraiment supprimer la photo de cette bi√®re ?')) {
                editPhotoBase64 = null;
                keepCurrentPhoto = false;
                document.getElementById('currentPhotoContainer').style.display = 'none';
                document.getElementById('editPhotoPreview').classList.add('hidden');
                document.getElementById('removePhotoBtn').style.display = 'none';
                document.getElementById('editPhotoLabel').classList.remove('has-file');
                document.getElementById('editPhotoLabel').innerHTML = '<i class="fas fa-camera text-2xl text-gray-400 mb-2"></i><p class="text-sm text-gray-600">Cliquez pour ajouter une photo</p>';
            }
        }

        document.getElementById('editBeerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const index = parseInt(document.getElementById('editBeerIndex').value);
            const beer = beers[index];
            
            // Mettre √† jour les donn√©es
            beer.name = document.getElementById('editBeerName').value;
            beer.type = document.getElementById('editBeerType').value;
            beer.abv = document.getElementById('editBeerABV').value;
            beer.stock33cl = parseInt(document.getElementById('editStock33cl').value);
            beer.stock75cl = parseInt(document.getElementById('editStock75cl').value);
            beer.origin = document.getElementById('editBeerOrigin').value;
            beer.description = document.getElementById('editBeerDescription').value;
            
            // G√©rer la photo
            if (editPhotoBase64) {
                // Nouvelle photo upload√©e
                beer.photo = editPhotoBase64;
            } else if (!keepCurrentPhoto) {
                // Photo supprim√©e
                beer.photo = null;
            }
            // Sinon, on garde la photo existante
            
            saveBeers();
            applyFilters();
            closeEditBeer();
            showNotification('"' + beer.name + '" modifi√©e avec succ√®s !');
        });

        function applyFilters() {
            const search = document.getElementById('searchInput').value.toLowerCase();
            const type = document.getElementById('filterType').value;
            
            filteredBeers = beers.filter(beer => {
                const matchSearch = beer.name.toLowerCase().includes(search) || 
                                   (beer.description && beer.description.toLowerCase().includes(search));
                const matchType = !type || beer.type === type;
                return matchSearch && matchType;
            });
            
            displayBeers();
        }

        function exportToJSON() {
            const data = JSON.stringify(beers, null, 2);
            const blob = new Blob([data], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'cave-bieres-' + new Date().toISOString().split('T')[0] + '.json';
            link.click();
            showNotification('Collection export√©e en JSON !');
        }

        function exportBackup() {
            const backup = {
                version: '1.0',
                exportDate: new Date().toISOString(),
                beers: beers,
                stats: {
                    total: beers.length,
                    total33cl: beers.reduce((sum, b) => sum + b.stock33cl, 0),
                    total75cl: beers.reduce((sum, b) => sum + b.stock75cl, 0)
                }
            };
            
            const data = JSON.stringify(backup, null, 2);
            const blob = new Blob([data], {type: 'application/json'});
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            const filename = 'sauvegarde-cave-bieres-' + new Date().toISOString().split('T')[0] + '.json';
            link.download = filename;
            link.click();
            showNotification('Sauvegarde compl√®te cr√©√©e ! Uploadez ce fichier sur GitHub pour le sauvegarder.');
        }

        function importBackup(event) {
            const file = event.target.files[0];
            if (!file) return;
            
            const reader = new FileReader();
            reader.onload = function(e) {
                try {
                    const data = JSON.parse(e.target.result);
                    
                    // V√©rifier le format
                    let importedBeers = [];
                    if (data.version && data.beers) {
                        // Nouveau format avec m√©tadonn√©es
                        importedBeers = data.beers;
                    } else if (Array.isArray(data)) {
                        // Ancien format (juste un tableau)
                        importedBeers = data;
                    } else {
                        throw new Error('Format de fichier invalide');
                    }
                    
                    // Confirmer l'import
                    const confirmMsg = 'Cette sauvegarde contient ' + importedBeers.length + ' bi√®re(s).\n\n';
                    const action = beers.length > 0 
                        ? 'Voulez-vous REMPLACER votre collection actuelle (' + beers.length + ' bi√®res) ou FUSIONNER les deux ?\n\nOK = Remplacer | Annuler = Fusionner'
                        : 'Voulez-vous restaurer cette sauvegarde ?';
                    
                    if (beers.length > 0) {
                        const replace = confirm(confirmMsg + action);
                        if (replace === null) return; // Annul√©
                        
                        if (replace) {
                            // Remplacer
                            beers = importedBeers;
                            showNotification('Collection restaur√©e : ' + beers.length + ' bi√®res');
                        } else {
                            // Fusionner
                            const oldCount = beers.length;
                            beers = beers.concat(importedBeers);
                            showNotification('Collections fusionn√©es : ' + oldCount + ' + ' + importedBeers.length + ' = ' + beers.length + ' bi√®res');
                        }
                    } else {
                        if (confirm(confirmMsg + action)) {
                            beers = importedBeers;
                            showNotification('Collection restaur√©e : ' + beers.length + ' bi√®res');
                        }
                    }
                    
                    saveBeers();
                    applyFilters();
                    
                } catch (error) {
                    showNotification('Erreur lors de l\'import : ' + error.message, 'error');
                }
            };
            reader.readAsText(file);
            
            // Reset input
            event.target.value = '';
        }

        function exportToGitHub() {
            const html = generateVitrineHTML();
            const blob = new Blob([html], {type: 'text/html'});
            const url = URL.createObjectURL(blob);
            const link = document.createElement('a');
            link.href = url;
            link.download = 'vitrine.html';
            link.click();
            showNotification('Vitrine export√©e ! Vous pouvez l\'uploader manuellement sur GitHub.');
        }

        function showGitHubGuide() {
            document.getElementById('githubModal').classList.remove('hidden');
            document.getElementById('githubModal').classList.add('flex');
        }

        function closeGitHubGuide() {
            document.getElementById('githubModal').classList.add('hidden');
            document.getElementById('githubModal').classList.remove('flex');
        }

        function showGitHubConfig() {
            const config = getGitHubConfig();
            if (config) {
                document.getElementById('githubUsername').value = config.username;
                document.getElementById('githubRepo').value = config.repo;
                document.getElementById('githubToken').value = config.token;
            }
            document.getElementById('githubConfigModal').classList.remove('hidden');
            document.getElementById('githubConfigModal').classList.add('flex');
        }

        function closeGitHubConfig() {
            document.getElementById('githubConfigModal').classList.add('hidden');
            document.getElementById('githubConfigModal').classList.remove('flex');
        }

        function getGitHubConfig() {
            const config = localStorage.getItem('githubConfig');
            return config ? JSON.parse(config) : null;
        }

        function saveGitHubConfig(username, repo, token) {
            localStorage.setItem('githubConfig', JSON.stringify({
                username: username,
                repo: repo,
                token: token
            }));
            updateConfigStatus();
        }

        function clearGitHubConfig() {
            if (confirm('√ätes-vous s√ªr de vouloir effacer la configuration GitHub ?')) {
                localStorage.removeItem('githubConfig');
                document.getElementById('githubConfigForm').reset();
                updateConfigStatus();
                showNotification('Configuration GitHub effac√©e');
            }
        }

        function updateConfigStatus() {
            const config = getGitHubConfig();
            const statusBtn = document.getElementById('configStatus');
            const saveBtn = document.getElementById('saveToGitHubBtn');
            const publishBtn = document.getElementById('publishToGitHubBtn');
            
            if (config) {
                statusBtn.innerHTML = '<i class="fas fa-check-circle"></i> GitHub configur√©';
                saveBtn.disabled = false;
                saveBtn.classList.remove('opacity-50', 'cursor-not-allowed');
                publishBtn.disabled = false;
                publishBtn.classList.remove('opacity-50', 'cursor-not-allowed');
            } else {
                statusBtn.innerHTML = '<i class="fas fa-cog"></i> Configurer GitHub';
                saveBtn.disabled = true;
                saveBtn.classList.add('opacity-50', 'cursor-not-allowed');
                publishBtn.disabled = true;
                publishBtn.classList.add('opacity-50', 'cursor-not-allowed');
            }
        }

        async function saveToGitHub() {
            const config = getGitHubConfig();
            if (!config) {
                showNotification('Veuillez d\'abord configurer GitHub', 'error');
                showGitHubConfig();
                return;
            }

            showNotification('Sauvegarde sur GitHub en cours...', 'success');

            const backup = {
                version: '1.0',
                exportDate: new Date().toISOString(),
                beers: beers,
                stats: {
                    total: beers.length,
                    total33cl: beers.reduce((sum, b) => sum + b.stock33cl, 0),
                    total75cl: beers.reduce((sum, b) => sum + b.stock75cl, 0)
                }
            };

            const content = JSON.stringify(backup, null, 2);
            const filename = 'sauvegarde-cave-bieres.json';
            
            try {
                // Encoder le contenu en base64
                const encodedContent = btoa(unescape(encodeURIComponent(content)));
                
                // V√©rifier si le fichier existe d√©j√† pour obtenir son SHA
                let sha = null;
                try {
                    const checkResponse = await fetch(
                        'https://api.github.com/repos/' + config.username + '/' + config.repo + '/contents/' + filename,
                        {
                            headers: {
                                'Authorization': 'token ' + config.token,
                                'Accept': 'application/vnd.github.v3+json'
                            }
                        }
                    );
                    
                    if (checkResponse.ok) {
                        const existingFile = await checkResponse.json();
                        sha = existingFile.sha;
                    }
                } catch (e) {
                    // Le fichier n'existe pas encore, c'est normal
                }

                // Cr√©er ou mettre √† jour le fichier
                const response = await fetch(
                    'https://api.github.com/repos/' + config.username + '/' + config.repo + '/contents/' + filename,
                    {
                        method: 'PUT',
                        headers: {
                            'Authorization': 'token ' + config.token,
                            'Accept': 'application/vnd.github.v3+json',
                            'Content-Type': 'application/json'
                        },
                        body: JSON.stringify({
                            message: 'Sauvegarde automatique - ' + new Date().toLocaleString('fr-FR'),
                            content: encodedContent,
                            sha: sha
                        })
                    }
                );

                if (response.ok) {
                    const result = await response.json();
                    showNotification('‚úÖ Sauvegarde r√©ussie sur GitHub ! (' + beers.length + ' bi√®res)');
                    console.log('Fichier sauvegard√©:', result.content.html_url);
                } else {
                    const error = await response.json();
                    throw new Error(error.message || 'Erreur lors de la sauvegarde');
                }
            } catch (error) {
                console.error('Erreur:', error);
                showNotification('‚ùå Erreur: ' + error.message + '. V√©rifiez votre configuration.', 'error');
            }
        }

        async function publishToGitHub() {
            const config = getGitHubConfig();
            if (!config) {
                showNotification('Veuillez d\'abord configurer GitHub', 'error');
                showGitHubConfig();
                return;
            }

            showNotification('üì§ Publication sur GitHub en cours...', 'success');

            try {
                // 1. Sauvegarder le JSON de donn√©es
                const backup = {
                    version: '1.0',
                    exportDate: new Date().toISOString(),
                    beers: beers,
                    stats: {
                        total: beers.length,
                        total33cl: beers.reduce((sum, b) => sum + b.stock33cl, 0),
                        total75cl: beers.reduce((sum, b) => sum + b.stock75cl, 0),
                        totalLiters: ((beers.reduce((sum, b) => sum + b.stock33cl, 0) * 0.33) + 
                                      (beers.reduce((sum, b) => sum + b.stock75cl, 0) * 0.75)).toFixed(1)
                    }
                };

                const jsonContent = JSON.stringify(backup, null, 2);
                const encodedJsonContent = btoa(unescape(encodeURIComponent(jsonContent)));

                // 2. G√©n√©rer le HTML de la vitrine
                const vitrineHTML = generateVitrineHTML();
                const encodedHTMLContent = btoa(unescape(encodeURIComponent(vitrineHTML)));

                // 3. Upload JSON
                await uploadToGitHub(config, 'sauvegarde-cave-bieres.json', encodedJsonContent, 'Sauvegarde automatique - ');

                // 4. Upload vitrine HTML (index.html)
                await uploadToGitHub(config, 'index.html', encodedHTMLContent, 'Mise √† jour vitrine - ');

                showNotification('‚úÖ Publication r√©ussie ! Vitrine + donn√©es upload√©es sur GitHub', 'success');
                
                // Afficher l'URL du site
                const siteUrl = 'https://' + config.username + '.github.io/' + config.repo + '/';
                console.log('Votre vitrine est disponible √†:', siteUrl);
                
                setTimeout(() => {
                    if (confirm('Votre vitrine a √©t√© publi√©e !\n\nVoulez-vous voir votre site ?\n\n' + siteUrl)) {
                        window.open(siteUrl, '_blank');
                    }
                }, 1000);

            } catch (error) {
                console.error('Erreur:', error);
                showNotification('‚ùå Erreur: ' + error.message, 'error');
            }
        }

        async function uploadToGitHub(config, filename, encodedContent, messagePrefix) {
            // V√©rifier si le fichier existe d√©j√†
            let sha = null;
            try {
                const checkResponse = await fetch(
                    'https://api.github.com/repos/' + config.username + '/' + config.repo + '/contents/' + filename,
                    {
                        headers: {
                            'Authorization': 'token ' + config.token,
                            'Accept': 'application/vnd.github.v3+json'
                        }
                    }
                );
                
                if (checkResponse.ok) {
                    const existingFile = await checkResponse.json();
                    sha = existingFile.sha;
                }
            } catch (e) {
                // Le fichier n'existe pas encore
            }

            // Cr√©er ou mettre √† jour le fichier
            const response = await fetch(
                'https://api.github.com/repos/' + config.username + '/' + config.repo + '/contents/' + filename,
                {
                    method: 'PUT',
                    headers: {
                        'Authorization': 'token ' + config.token,
                        'Accept': 'application/vnd.github.v3+json',
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({
                        message: messagePrefix + new Date().toLocaleString('fr-FR'),
                        content: encodedContent,
                        sha: sha
                    })
                }
            );

            if (!response.ok) {
                const error = await response.json();
                throw new Error('Erreur upload ' + filename + ': ' + (error.message || 'Unknown'));
            }

            return await response.json();
        }

        function generateVitrineHTML() {
            // Calculs pr√©alables
            const currentDate = new Date().toLocaleDateString('fr-FR');
            const totalBeers = beers.length;
            const total33 = beers.reduce((sum, b) => sum + b.stock33cl, 0);
            const total75 = beers.reduce((sum, b) => sum + b.stock75cl, 0);
            const totalLiters = ((total33 * 0.33) + (total75 * 0.75)).toFixed(1);
            
            // G√©n√©ration des cartes de bi√®res
            let beerCards = '';
            beers.forEach(beer => {
                const totalStock = beer.stock33cl + beer.stock75cl;
                const stockClass = totalStock === 0 ? 'stock-empty' : totalStock < 5 ? 'stock-low' : 'stock-ok';
                const stockText = totalStock === 0 ? '‚ö†Ô∏è Rupture de stock' : totalStock < 5 ? '‚ö° Stock limit√©' : '‚úì Disponible';
                
                const safeName = escapeHtml(beer.name);
                const safeDescription = escapeHtml(beer.description);
                const safeOrigin = escapeHtml(beer.origin);
                const safeAbv = escapeHtml(beer.abv);
                
                beerCards += '<div class="card overflow-hidden">';
                
                if (beer.photo) {
                    beerCards += '<div class="beer-image-container" data-src="' + beer.photo.replace(/"/g, '&quot;') + '" data-name="' + safeName.replace(/"/g, '&quot;') + '">';
                    beerCards += '<img src="' + beer.photo + '" alt="' + safeName + '" class="beer-image">';
                    beerCards += '<div class="image-overlay"><i class="fas fa-search-plus"></i></div>';
                    beerCards += '</div>';
                } else {
                    beerCards += '<div class="bg-gradient-to-br from-gray-100 to-gray-200 h-96 flex items-center justify-center"><i class="fas fa-beer text-8xl text-gray-400"></i></div>';
                }
                
                beerCards += '<div class="p-6">';
                beerCards += '<div class="flex justify-between items-start mb-3">';
                beerCards += '<h3 class="text-2xl font-bold text-gray-800">' + safeName + '</h3>';
                beerCards += '<span class="stock-badge ' + stockClass + '">' + stockText + '</span>';
                beerCards += '</div>';
                
                beerCards += '<div class="flex flex-wrap gap-2 mb-4">';
                beerCards += '<span class="inline-block px-3 py-1 bg-purple-100 text-purple-800 rounded-full text-sm font-semibold">' + beer.type + '</span>';
                if (safeAbv) {
                    beerCards += '<span class="inline-block px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-sm font-semibold">' + safeAbv + '% vol.</span>';
                }
                if (safeOrigin) {
                    beerCards += '<span class="inline-block px-3 py-1 bg-green-100 text-green-800 rounded-full text-sm font-semibold"><i class="fas fa-map-marker-alt"></i> ' + safeOrigin + '</span>';
                }
                beerCards += '</div>';
                
                if (safeDescription) {
                    beerCards += '<div class="mb-4 p-4 bg-gray-50 rounded-lg border-l-4 border-purple-500"><p class="text-gray-700 italic">"' + safeDescription + '"</p></div>';
                }
                
                beerCards += '<div class="grid grid-cols-2 gap-4">';
                beerCards += '<div class="bg-blue-50 p-4 rounded-lg text-center border border-blue-100">';
                beerCards += '<div class="text-sm font-semibold text-gray-600 mb-1"><i class="fas fa-bottle-droplet text-blue-600"></i> 33cl</div>';
                beerCards += '<div class="text-3xl font-bold text-blue-600">' + beer.stock33cl + '</div>';
                beerCards += '</div>';
                beerCards += '<div class="bg-purple-50 p-4 rounded-lg text-center border border-purple-100">';
                beerCards += '<div class="text-sm font-semibold text-gray-600 mb-1"><i class="fas fa-wine-bottle text-purple-600"></i> 75cl</div>';
                beerCards += '<div class="text-3xl font-bold text-purple-600">' + beer.stock75cl + '</div>';
                beerCards += '</div>';
                beerCards += '</div>';
                
                beerCards += '</div></div>';
            });
            
            const html = '<!DOCTYPE html>\n' +
'<html lang="fr">\n' +
'<head>\n' +
'    <meta charset="UTF-8">\n' +
'    <meta name="viewport" content="width=device-width, initial-scale=1.0">\n' +
'    <title>Ma Cave √† Bi√®res - Vitrine</title>\n' +
'    <script src="https://cdn.tailwindcss.com"><\/script>\n' +
'    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">\n' +
'    <style>\n' +
'        @import url(\'https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&display=swap\');\n' +
'        * { font-family: \'Inter\', sans-serif; }\n' +
'        body { background: linear-gradient(to bottom right, #1e293b, #334155, #475569); min-height: 100vh; }\n' +
'        .card { background: white; border-radius: 1rem; box-shadow: 0 4px 6px -1px rgba(0,0,0,0.1); transition: all 0.3s ease; }\n' +
'        .card:hover { transform: translateY(-4px); box-shadow: 0 20px 25px -5px rgba(0,0,0,0.1); }\n' +
'        .gradient-header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); }\n' +
'        .beer-image-container { position: relative; width: 100%; height: 400px; overflow: hidden; cursor: pointer; }\n' +
'        .beer-image { width: 100%; height: 100%; object-fit: cover; transition: transform 0.3s ease; }\n' +
'        .beer-image-container:hover .beer-image { transform: scale(1.05); }\n' +
'        .image-overlay { position: absolute; top: 0; left: 0; right: 0; bottom: 0; background: rgba(0,0,0,0.5); display: flex; align-items: center; justify-content: center; opacity: 0; transition: opacity 0.3s ease; }\n' +
'        .image-overlay i { color: white; font-size: 3rem; }\n' +
'        .beer-image-container:hover .image-overlay { opacity: 1; }\n' +
'        .lightbox { display: none; position: fixed; z-index: 9999; left: 0; top: 0; width: 100%; height: 100%; background-color: rgba(0,0,0,0.95); align-items: center; justify-content: center; }\n' +
'        .lightbox-content { max-width: 90%; max-height: 90%; object-fit: contain; border-radius: 0.5rem; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); }\n' +
'        .lightbox-close { position: absolute; top: 20px; right: 35px; color: #fff; font-size: 40px; font-weight: bold; cursor: pointer; transition: 0.3s; }\n' +
'        .lightbox-close:hover { color: #bbb; }\n' +
'        .lightbox-caption { position: absolute; bottom: 20px; left: 0; right: 0; text-align: center; color: #fff; font-size: 1.5rem; font-weight: bold; text-shadow: 2px 2px 4px rgba(0,0,0,0.8); }\n' +
'        .stock-badge { display: inline-block; padding: 0.5rem 1rem; border-radius: 9999px; font-size: 0.875rem; font-weight: 600; }\n' +
'        .stock-low { background: #fef3c7; color: #92400e; }\n' +
'        .stock-ok { background: #d1fae5; color: #065f46; }\n' +
'        .stock-empty { background: #fee2e2; color: #991b1b; }\n' +
'    </style>\n' +
'</head>\n' +
'<body class="p-4 md:p-8">\n' +
'    <div id="lightbox" class="lightbox" onclick="closeLightbox()">\n' +
'        <span class="lightbox-close">&times;</span>\n' +
'        <img id="lightbox-img" class="lightbox-content">\n' +
'        <div id="lightbox-caption" class="lightbox-caption"></div>\n' +
'    </div>\n' +
'    <div class="max-w-7xl mx-auto">\n' +
'        <div class="card gradient-header text-white p-8 md:p-12 mb-8 text-center">\n' +
'            <h1 class="text-4xl md:text-6xl font-bold mb-4"><i class="fas fa-beer"></i> Ma Cave √† Bi√®res</h1>\n' +
'            <p class="text-xl md:text-2xl opacity-90">Collection Premium</p>\n' +
'            <p class="text-lg mt-2 opacity-75">Derni√®re mise √† jour : ' + currentDate + '</p>\n' +
'        </div>\n' +
'        <div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">\n' +
'            <div class="card p-8 text-center"><div class="text-5xl font-bold text-purple-600">' + totalBeers + '</div><div class="text-gray-600 font-medium mt-2 text-lg">Bi√®res diff√©rentes</div></div>\n' +
'            <div class="card p-8 text-center"><div class="text-5xl font-bold text-blue-600">' + total33 + '</div><div class="text-gray-600 font-medium mt-2 text-lg">Bouteilles 33cl</div></div>\n' +
'            <div class="card p-8 text-center"><div class="text-5xl font-bold text-indigo-600">' + total75 + '</div><div class="text-gray-600 font-medium mt-2 text-lg">Bouteilles 75cl</div></div>\n' +
'            <div class="card p-8 text-center"><div class="text-5xl font-bold text-green-600">' + totalLiters + '</div><div class="text-gray-600 font-medium mt-2 text-lg">Litres totaux</div></div>\n' +
'        </div>\n' +
'        <div class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8">\n' +
'            ' + beerCards + '\n' +
'        </div>\n' +
'        <div class="text-center text-white mt-12 pb-8"><p class="text-lg opacity-75"><i class="fas fa-beer"></i> Collection g√©n√©r√©e automatiquement</p></div>\n' +
'    </div>\n' +
'    <script>\n' +
'        function openLightbox(src, caption) {\n' +
'            document.getElementById("lightbox").style.display = "flex";\n' +
'            document.getElementById("lightbox-img").src = src;\n' +
'            document.getElementById("lightbox-caption").innerHTML = caption;\n' +
'            document.body.style.overflow = "hidden";\n' +
'        }\n' +
'        function closeLightbox() {\n' +
'            document.getElementById("lightbox").style.display = "none";\n' +
'            document.body.style.overflow = "auto";\n' +
'        }\n' +
'        document.addEventListener("keydown", function(e) {\n' +
'            if (e.key === "Escape") closeLightbox();\n' +
'        });\n' +
'        document.addEventListener("DOMContentLoaded", function() {\n' +
'            var containers = document.querySelectorAll(".beer-image-container");\n' +
'            containers.forEach(function(container) {\n' +
'                container.addEventListener("click", function() {\n' +
'                    var src = this.getAttribute("data-src");\n' +
'                    var name = this.getAttribute("data-name");\n' +
'                    if (src && name) {\n' +
'                        openLightbox(src, name);\n' +
'                    }\n' +
'                });\n' +
'            });\n' +
'        });\n' +
'    <\/script>\n' +
'</body>\n' +
'</html>';
            
            return html;
        }

        document.getElementById('githubConfigForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const username = document.getElementById('githubUsername').value.trim();
            const repo = document.getElementById('githubRepo').value.trim();
            const token = document.getElementById('githubToken').value.trim();
            
            if (!username || !repo || !token) {
                showNotification('Tous les champs sont requis', 'error');
                return;
            }

            saveGitHubConfig(username, repo, token);
            closeGitHubConfig();
            showNotification('Configuration GitHub enregistr√©e !');
        });

        document.getElementById('beerForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            const newBeer = {
                name: document.getElementById('beerName').value,
                type: document.getElementById('beerType').value,
                abv: document.getElementById('beerABV').value,
                stock33cl: parseInt(document.getElementById('stock33cl').value),
                stock75cl: parseInt(document.getElementById('stock75cl').value),
                description: document.getElementById('beerDescription').value,
                origin: document.getElementById('beerOrigin').value,
                photo: currentPhotoBase64
            };

            beers.push(newBeer);
            saveBeers();
            applyFilters();
            this.reset();
            
            // Reset photo
            currentPhotoBase64 = null;
            document.getElementById('photoPreview').classList.add('hidden');
            document.getElementById('photoLabel').classList.remove('has-file');
            document.getElementById('photoLabel').innerHTML = '<i class="fas fa-camera text-2xl text-gray-400 mb-2"></i><p class="text-sm text-gray-600">Cliquez pour ajouter une photo</p>';
            
            showNotification('"' + newBeer.name + '" ajout√©e !');
        });

        document.getElementById('searchInput').addEventListener('input', applyFilters);
        document.getElementById('filterType').addEventListener('change', applyFilters);

        updateStats();
        displayBeers();
        updateConfigStatus();
    </script>
</body>
</html>